let Joi,RefreshModel;_3c7‍.x([["default",()=>_3c7‍.o]]);_3c7‍.w("joi",[["default",["Joi"],function(v){Joi=v}]]);_3c7‍.w("../../model",[["RefreshModel",["RefreshModel"],function(v){RefreshModel=v}]]);


const logoutController = {
    async logout(req, res, next) {
        // validation
        const refreshSchema = Joi.object({
            refresh_token: Joi.string().required()
        });

        const { error } = refreshSchema.validate(req.body);
        if (error) {
            return next(error)
        };

        try {
            await RefreshModel.deleteOne({ token: req.body.refresh_token })
        } catch (error) {
            return next(new Error("Something went to wrong in the database"))
        }
        res.json({ msg: "User logout" })
    }

};

_3c7‍.d(logoutController);